% config/commands.tex
\newcommand{\Finding}[3]{
	\section*{#1}
	\textbf{Severity:} #2\\
	\textbf{Description:} #3
}

% Moved to Settings.txt 
%\definecolor{sev-high}{HTML}{FF4C4C}
%\definecolor{sev-mediumhigh}{HTML}{FF914D}
%\definecolor{sev-medium}{HTML}{FFD966}
%\definecolor{sev-low}{HTML}{9FE2BF}
%\definecolor{sev-info}{HTML}{7EC8E3}

% Counter for Finding Summery 
\newcounter{criticalCount}
\newcounter{highCount}
\newcounter{mediumCount}
\newcounter{lowCount}
\newcounter{infoCount}

\usepackage{totcount}
\regtotcounter{criticalCount}
\regtotcounter{highCount}
\regtotcounter{mediumCount}
\regtotcounter{lowCount}
\regtotcounter{infoCount}


% This allows Linking with \begin{findingbox}
	\usepackage{tcolorbox}
	\tcbuselibrary{breakable, skins}
	\usepackage{xstring} % Needed for string comparison
	
	\newtcolorbox{findingbox}[1]{%
		colback=white,
		colframe=sev-#1,            % dynamic color from severity
		coltitle=white,
		%colbacktitle=sev-#1,
		%title=#1,
		fonttitle=\bfseries\large,
		breakable,
		sharp corners=southwest,
		enhanced,
		left=2mm,
		right=2mm,
		top=2mm,
		bottom=2mm,
		before skip=10pt,
		after skip=10pt,
		boxrule=2.5pt,                 % increase the border width  (default ~0.5pt)
		% increment counter based on severity
		before upper={%
			% increment counter based on severity
			\IfStrEqCase{#1}{%
				{critical}{\stepcounter{criticalCount}}%
				{high}{\stepcounter{highCount}}%
				{medium}{\stepcounter{mediumCount}}%
				{low}{\stepcounter{lowCount}}%
				{info}{\stepcounter{infoCount}}%
			}[\PackageError{findingbox}{Unknown severity `#1`}{}]%
		}
	}
	
	% Define high level summary box
	\newtcolorbox{summarybox}[1][]{%
		colback=white,
		colframe=secondary,
		coltitle=white,
		colbacktitle=box-bg,
		%title=High-Level Summary,
		%fonttitle=\bfseries\large,
		breakable,
		sharp corners=southwest,
		enhanced,
		left=2mm,
		right=2mm,
		top=2mm,
		bottom=2mm,
		before skip=10pt,
		after skip=10pt,
		#1
	}
	
	% Box for visual summary of severity counts
	\newtcolorbox{severitysummary}[1][]{
		colback=white,
		colframe=secondary,
		sharp corners=southwest,
		enhanced,
		before skip=5pt,
		after skip=5pt,
		boxrule=0.5pt,
		fontupper=\sffamily,
		left=4mm,
		right=4mm,
		top=2mm,
		bottom=2mm,
		#1
	}
	
	
	
	% Severity summary table macro with 5 levels
	\newcommand{\SeverityTable}[5]{
		\begin{center}
			\begin{tabular}{|c|c|c|c|c|}
				\hline
				\rowcolor{gray!20}
				\textbf{\textcolor{sev-critical}{Critical}} &
				\textbf{\textcolor{sev-high}{High}} &
				\textbf{\textcolor{sev-medium}{Medium}} &
				\textbf{\textcolor{sev-low}{Low}} &
				\textbf{\textcolor{sev-info}{Informational}} \\
				\hline
				\textbf{\textcolor{sev-critical}{#1}} &
				\textbf{\textcolor{sev-high}{#2}} &
				\textbf{\textcolor{sev-medium}{#3}} &
				\textbf{\textcolor{sev-low}{#4}} &
				\textbf{\textcolor{sev-info}{#5}} \\
				\hline
			\end{tabular}
		\end{center}
	}
	
	\tcbuselibrary{listings}
	
	\newtcblisting{commandbox}[1][]{%
		colback=gray!10,
		colframe=gray!50,
		fontupper=\ttfamily\footnotesize,
		boxrule=0.5pt,
		sharp corners,
		breakable,
		enhanced,
		left=2mm,
		right=2mm,
		top=2mm,
		bottom=2mm,
		before skip=10pt,
		after skip=10pt,
		listing only,
		listing options={
			basicstyle=\ttfamily\footnotesize,
			breaklines=true,         % allow breaking long lines
			showstringspaces=false,  % donâ€™t mark spaces
			columns=fullflexible,
			keepspaces=true,         % preserve indentation!
			upquote=true
		},
		title=#1
	}